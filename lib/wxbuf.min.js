/*!
 * wxbuf.js v1.0.0
 * (c) 2024 lingluo
 * the MIT License.
 */
const t=function(t){return Object.prototype.toString.call(t)==="[object Object]"};const e=function(t){return Object.prototype.toString.call(t)==="[object Number]"};const n=function(t){return Object.prototype.toString.call(t)==="[object Function]"};const o=function(t){return Object.prototype.toString.call(t)==="[object String]"};const s=function(t,e){return t.hasOwnProperty(e)};const r=function(t){return Array.isArray(t)};const i=function(e){if(t(e)){return!Object.keys(e).length}if(r(e)){return!e.length}if(o(e)){return e.trim()}if(e===null||e===undefined){return true}return false};const c=function(t,...e){return Object.assign(t,...e)};const a=function(t,e){t=t.split("");t[e]=t[e].toUpperCase();return t.join("")};const u=function(t,e=""){return e+t.split("?")[0].replace(/^\/+/,"")};const f=function(){};const l=function(e){return e&&t(e)&&e.target&&e.timeStamp&&e.currentTarget&&e.type};const p=function(t){let e,n;e=n=t.selectOwnerComponent();if(n===null){return t}while(e=n.selectOwnerComponent()){n=e}return n};const h=function(e){if(!t(e)){return""}const n=[];for(let o in e){if(e.hasOwnProperty(o)){let s=e[o];if(t(s)||r(s)){s=JSON.stringify(s)}n.push(`${o}=${s}`)}}return n.join("&")};const g=function(t=""){const e={};const n=t.split("&");if(n.length){n.forEach((t=>{const[n,o]=t.split("=");e[n]=o}))}return e};const d=function(e,n){n=t(n)?h(n):n;return n?[e,n].join(e.includes("?")?"&":"?"):e};const m=function(n,o=false){if(!t(n)||o){return n}for(let o in n){const i=n[o];if(s(n,o)&&i){try{const s=JSON.parse(i);if(t(s)||r(s)||s===null){n[o]=s}else if(e(s)&&i===s.toString()){n[o]=s}}catch(t){}if(i==="undefined"){n[o]=undefined}else if(i==="true"){n[o]=true}else if(i==="false"){n[o]=false}}}return n};const w=function(){if(__wxConfig&&__wxConfig.tabBar&&__wxConfig.tabBar.list){return __wxConfig.tabBar.list.map((t=>t.pagePath.replace(/\.html$/,"")))}return[]};const S=function(t){return w().includes(u(t))};const $=function(){const t=getCurrentPages().slice(0).pop();if(t&&__wxConfig&&__wxConfig.page&&__wxConfig.page[t.route+".html"]){return __wxConfig.page[t.route+".html"].window.navigationBarTitleText}return""};const x=function(t){return __wxAppCode__?__wxAppCode__[t.replace(/^\//,"")+".json"]||{}:{}};const y=t=>{if(/->/.test(t)){const[e,n]=t.split("->").map((t=>o(t)?t.trim():t));t=n?n:e;return[e,t]}return[t,t]};const v=function(t,e,n){if(!s(t,e)){Object.defineProperty(t,e,{get:()=>n})}};const P=(t,e)=>{const n=e.split(/\[|\]|\./).filter(Boolean).map((t=>t.replace(/\'|\"/g,"")));let o=undefined;for(let e=0;e<n.length;e++){const s=n[e];try{t=o=t[s]}catch(t){return undefined}}return o};const b=[];const T=[];function E(t){b.push(t)}function O(t){const e=b.indexOf(t);const n=b[e]||null;if(e>-1){b.splice(e,1)}return n}function _(t){T.push(t)}function k(t){const e=T.findIndex((e=>e.context===t));const n=T.find((e=>e.context===t));if(e>-1){T.splice(e,1)}return n}function A(){return b.slice(0)}function B(){return T.slice(0)}function C(){const t=[];b.forEach((e=>{if(n(e.getTabBar)){const o=e.getTabBar();if(o&&n(o.setData)){t.push(o)}}}));return t}function j(){const t=[];b.forEach((e=>{if(n(e.getAppBar)){const o=e.getAppBar();if(o&&n(o.setData)&&!t.includes(o)){t.push(o)}}}));return t}const D=function(t,e){const n=e.split("?")[1];e=e.split("?")[0];const o=e.startsWith("/")?[]:t.split("/");const s=e.split("/");let r=null;o.pop();while(s.length){r=s.shift();if(r===".."){o.pop()}else if(r===""||r==="."){continue}else if(r.indexOf(".")===-1){o.push(r)}else{throw new Error(`path'${e}' is invalid`)}}return o.join("/").replace(/^\/*/,"/")+(n?`?${n}`:"")};var L={resolve:D};const U=["data","onLoad","onShow","onReady","onHide","onUnload","onPullDownRefresh","onReachBottom","onShareAppMessage","onShareTimeline","onPageScroll","onTabItemTap","onResize","onAddToFavorites"];const R=wx.getStorageSync;const M=function(){const t={};return{get(e){if(!t.hasOwnProperty(e)){t[e]=R.call(wx,e)}return t[e]===undefined?"":t[e]},set(e,n){t[e]=n},remove(e){delete t[e]}}}();let I={};const W=function(t){I=t};const N=function(t){return I[t]};const J=function(t){if(n(I[t])){return I[t].apply(getApp(),[].slice.call(arguments,1))}};const K={storage:"mixinStorage",store:"mixinStore"};const G={storage:"injectStorage",store:"injectStore"};const Q={storage:"onStorageChange",store:"onStoreChange"};let H=null;let F=[];const q=function(t){F.forEach((({kvs:e,name:n})=>{const o=G[n];const r=N(o);if(!r)return;const{keys:a,namespace:u}=r;let f=u?c({},t.data[u]||{}):{};a.forEach((t=>{const[n,o]=y(t);if(s(e,n)){f[o]=e[n]}}));if(!i(f)){t.setData(u?{[u]:f}:f)}}))};const z=function(t,e){if(e.mixinStore||e.mixinStorage){const n={};F.forEach((({kvs:t,name:o})=>{const r=e[K[o]]||[];r.forEach((e=>{const[o,r]=y(e);if(s(t,o)){n[r]=t[o]}}))}));if(!i(n)){t.setData(n)}}};const V=function(t,e){F.forEach((({kvs:o,oldkvs:s,name:r})=>{const i=e[Q[r]];if(n(i)){i.apply(t,[o,s])}}))};function X(t){const e=F.findIndex((e=>e.name===t.name));if(e>-1){const{kvs:n,oldkvs:o,name:s}=F[e];t={kvs:c(n,t.kvs),oldkvs:c(o,t.oldkvs),name:s};F.splice(e,1)}F.push(t)}function Y(){if(H){clearTimeout(H);H=null}}function Z(){H=setTimeout((function(){A().forEach((t=>{z(t,t);q(t);V(t,t)}));B().forEach((({context:t,option:e})=>{z(t,e);q(t);V(t,e)}));C().concat(j()).forEach((t=>{z(t,t.$constructorOptions);q(t);V(t,t.$constructorOptions)}));F.forEach((({kvs:t,oldkvs:e,name:n})=>J(Q[n],t,e)));F=[]}),0)}function tt(t){Y();X(t);Z()}class et{constructor(){this.watchers=[]}add(e){if(t(e)&&!i(e)){this.watchers.push(e)}}invoke(t,e,...n){for(let o=0,s=this.watchers.length;o<s;o++){const s=this.watchers[o];if(s.hasOwnProperty(t)){s[t].call(e,...n)}}}}let nt=new et;const ot=(t={})=>{nt.add(t)};const st=function(t,e,...n){nt.invoke(e,t,...n)};let rt={methodPrefix:"",parseUrlArgs:false,enableGlobalShareAppMessage:false,enableGlobalShareTimeline:false,storeKey:"globalData"};const it={page:{},component:{}};const ct=App;const at=Page;const ut=Component;const ft=Behavior;const lt=wx;const pt=wx.setStorage;const ht=wx.batchSetStorage;const gt=wx.batchSetStorageSync;const dt=wx.removeStorage;wx.getStorageSync;const mt=wx.setStorageSync;const wt=wx.removeStorageSync;const St=wx.clearStorage;const $t=wx.clearStorageSync;const xt=wx.navigateTo;const yt=wx.redirectTo;const vt=wx.reLaunch;const Pt=wx.switchTab;wx=Object.assign(Object.create(lt.__proto__),wx);const bt={extend(t){it.page=c(it.page,t)}};const Tt={extend(t){it.component=c(it.component,t)}};const Et=function(t,e){const o=it[e];for(let e in o){const s=o[e];if(n(s)){t[e]=s}}};const Ot=function(t,e=true){for(let o in t){if(t.hasOwnProperty(o)&&(!e||!U.includes(o))&&n(t[o])){const e=t[o];t[o]=function(t){if(l(t)&&!t._ignore){st(this,"on"+a(t.type,0),c(t,{path:p(this).route}))}if(e){if(N("onEventDispatch")&&l(t)&&!t._ignore){let n=true;let o=[t];const s=function(){n=false;o=[].slice.call(arguments,0)};J("onEventDispatch",t,s);v(t,"_ignore",true);if(!n){return e.apply(this,o)}}else{if(l(t)){v(t,"_ignore",true)}return e.apply(this,arguments)}}}}}};const _t=function(t){if(!/^\//.test(t.url)){throw new URIError(`url必须以/开头`)}return J("beforePageEnter",t,x(u(t.url)))??true};const kt=function(t,e=false){const n=d(t.url,t.params);if(e){yt.call(wx,{url:n})}else{xt.call(wx,{url:n})}};const At=function(t){const e=__wxAppCode__||{};let n;const o=/\.json$/i;for(let r in e){n=e[r];if(s(e,r)&&o.test(r)&&n.name===t){return`/${r.replace(o,"")}`}}return null};const Bt=function(t){if(t.name&&!t.url){const e=At(t.name);if(!e){throw new Error(`[wxbuf]: 不存在name为'${t.name}'的页面`)}t.url=e}};const Ct=function(t){Bt(t);if(_t(t)){ce(t,this);const e=fe(t);ke(t);kt(t);return e}return Promise.reject()};const jt=function(t){Bt(t);if(_t(t)){ke(t);kt(t,true)}};const Dt=function(t,e){if(e.$feature){e.$feature.resolve(t);e.$feature=null}return wx.navigateBack()};const Lt=function(t,e){const n=te();const o=L.resolve(n?n.route:"/",e.url);if(J("beforePageEnter",Object.assign({},e,{url:o}),x(o))===false){return Promise.reject()}if(t===Pt){Ce(e);e.url=e.url.split("?")[0]}return t.call(wx,e)};const Ut=function(t){return Lt(xt,t)};const Rt=function(t){return Lt(yt,t)};const Mt=function(t){return Lt(vt,t)};const It=function(t){Be=null;return Lt(Pt,t)};const Wt=function(e,o){const s={route:this.$route,value:o};const r=function(o,r){if(t(r)&&n(r[e])){r[e].call(o,s)}};A().forEach((t=>r(t,t.listeners)));B().forEach((({context:t,option:e})=>r(t,e.listeners)));C().concat(j()).forEach((t=>r(t,t.$constructorOptions.listeners)));r(getApp(),N("listeners"))};const Nt=function(t,e,n){const o=`mixin${a(n,0)}`;const r=`inject${a(n,0)}`;const i=function(e,n=[]){n.forEach((n=>{const[o,r]=y(n);if(s(t,o)){e.data[r]=t[o]}}))};const c=function(e){const n=N(r);if(!n)return;const{keys:o,namespace:i}=n;o.forEach((n=>{const[o,r]=y(n);if(s(t,o)){if(i){if(!e.data[i]){e.data[i]={}}e.data[i][r]=t[o]}else{e.data[r]=t[o]}}}))};A().forEach((t=>{i(t,t[o]);c(t)}));B().forEach((({context:t,option:e})=>{i(t,e[o]);c(t)}));C().concat(j()).forEach((t=>{i(t,t.$constructorOptions[o]);c(t)}));tt({kvs:t,oldkvs:e,name:n})};const Jt=function(t){const{success:e,key:n,data:o}=t;if(!n)return;const s=M.get(n);t.success=function(){M.set(n,o);Nt({[n]:o},{[n]:s},"storage");return(e||f).apply(this,arguments)};return pt.apply(wx,arguments)};const Kt=function(t){const{kvList:e,success:n}=t;const o=function(){const t={};e.forEach((({key:e})=>t[e]=Qt(e)));return t}();t.success=function(){const t={};e.forEach((({key:e,value:n})=>{t[e]=n;M.set(e,n)}));Nt(t,o,"storage");return(n||f).apply(this,arguments)};return ht.apply(wx,arguments)};const Gt=function(t){const{key:e,success:n}=t;if(!e)return;const o=M.get(e);t.success=function(){M.remove(e);Nt({[e]:""},{[e]:o});return(n||f).apply(this,arguments)};return dt.call(wx,t)};const Qt=function(t){return M.get(t)};const Ht=function(t,e){if(!t)return;const n=M.get(t);M.set(t,e);mt.call(wx,t,e);Nt({[t]:e},{[t]:n},"storage")};const Ft=function(t){const e={};const n={};t.forEach((({key:t,value:o})=>{e[t]=o;M.set(t,o);n[t]=Qt(t)}));Nt(e,n,"storage");return gt.apply(wx,arguments)};const qt=function(t){if(!t)return;const e=M.get(t);M.remove(t);wt.call(wx,t);Nt({[t]:""},{[t]:e},"storage")};const zt=function(t={}){const e=t.success;const n=lt.getStorageInfoSync().keys;t.success=function(){const t={};const o={};n.forEach((e=>{t[e]="";M.remove(e);o[e]=Qt(e)}));Nt(t,o,"storage");return(e||f).apply(wx,arguments)};return St.call(wx,t)};const Vt=function(){const t={};const e={};lt.getStorageInfoSync().keys.forEach((n=>{t[n]="";M.remove(n);e[n]=Qt(n)}));Nt(t,e,"storage");return $t.apply(wx,arguments)};const Xt=function(t){const e=getApplication()[rt.storeKey];return e?t?e[t]:e:undefined};const Yt=function(t,e){const{storeKey:n}=rt;const o=getApplication();if(!o[n]){o[n]={}}const s=o[n][t];o[n][t]=e;Nt({[t]:e},{[t]:s},"store")};const Zt=function(){return B().map((t=>t.context)).concat(C()).concat(j()).filter((t=>t.is===this.is))};const te=function(){const t=getCurrentPages();return t.length?t[t.length-1]:null};const ee=function(t,e){const n=getApp()[rt.storeKey];["Store","Storage"].forEach((o=>{const s=t[`mixin${o}`];if(r(s)){const t={};s.forEach((e=>{const[s,r]=y(e);t[r]=o==="Store"?n[s]:Qt(s)}));e.setData(t)}}))};const ne=function(t){const e=getApp()[rt.storeKey];["Store","Storage"].forEach((n=>{const o=N(`inject${n}`);if(!o)return;const s=o.keys;const i=o.namespace;if(r(s)){const o={};s.forEach((t=>{const[s,r]=y(t);o[r]=n==="Store"?e[s]:Qt(s)}));if(i){const e=c({},t.data[i]||{},o);t.setData({[i]:e})}else{t.setData(o)}}}))};const oe=function(t,e,n){const o=t[e];t[e]=function(){n.apply(this,arguments);if(o){return o.apply(this,arguments)}}};const se=function(t){const{methodPrefix:e}=rt;t[`${e}openPage`]=Ct;t[`${e}replacePage`]=jt;t[`${e}getStore`]=Xt;t[`${e}setStore`]=Yt;t[`${e}getStorageSync`]=Qt;t[`${e}setStorageSync`]=Ht;t[`${e}removeStorageSync`]=qt;t[`${e}setStorage`]=Jt;t[`${e}removeStorage`]=Gt;t[`${e}batchSetStorage`]=Kt;t[`${e}batchSetStorageSync`]=Ft;t[`${e}clearStorage`]=zt;t[`${e}clearStorageSync`]=Vt;t[`${e}fireEvent`]=Wt};const re=function(t){const e=t.getPageId();return new Proxy({},{get(t,o){const s=getCurrentPages().find((t=>t.getPageId()===e));if(s){return n(s[o])?s[o].bind(s):s[o]}else{console.warn("wxbuf: 访问了不存在的页面实例");return undefined}}})};let ie=null;const ce=function(t,e){ie={success:t.success,url:u(t.url),page:e===wx||e===getApp()?te():p(e)}};const ae=function(t){if(ie&&ie.url===t.route){t.$opener=ie.page;if(n(ie.success)){ie.success.call(ie.page,re(t))}ie=null}else{t.$opener=null}};let ue=null;const fe=function(t){return new Promise(((e,n)=>{ue={resolve:e,url:u(t.url)}}))};const le=function(t){if(ue&&t.route===ue.url){t.$feature=ue;ue=null}const e=t.onUnload||f;t.onUnload=function(){if(t.$feature){t.$feature.resolve();t.$feature=null}return e.apply(t,arguments)}};const pe=function(t){t.$setData=t.setData};const he=function(t,e){const o=t.observers||{};if(i(o))return;const s=e.setData;e.setData=function(){const t={};for(let e in o){if(e!=="**"){t[e]=P(this.data,e)}}s.apply(this,arguments);for(let e in o){const s=o[e];if(e==="**"){s.call(this,this.data)}else{const o=P(this.data,e);const r=t[e];if(n(s)&&o!==r){s.call(this,o,r)}}}}};const ge=function(t,e){const o=t.computed||{};if(i(o))return;const s=e.$setData;const r=function(t,e){const o={};for(let s in t){const r=t[s];if(n(r)){o[s]=r.call(e)}}if(!i(o)){s.call(e,o)}};e.setData=function(){s.apply(e,arguments);r(o,e)};r(o,e)};const de=function(t){const e=t.setData;t.setData=function(){e.apply(this,arguments);if(this.$components&&this.$components.length){this.$components.forEach((t=>{if(t.$constructorOptions&&t.$constructorOptions.parentLifetimes&&t.$constructorOptions.parentLifetimes.setData){t.$constructorOptions.parentLifetimes.setData.call(t,this.data)}}))}}};const me=function(e){if(rt.enableGlobalShareAppMessage&&!e.onShareAppMessage){e.onShareAppMessage=function(e){let n={title:$(),url:`${this.route}${this.$rawParamsQuery?`?${this.$rawParamsQuery}`:""}`};if(N("onPageShareAppMessage")){const o=J("onPageShareAppMessage",this,n,e);if(t(o)){n=o}}return n}}};const we=function(e){const n=e.onShareAppMessage;if(n){e.onShareAppMessage=function(e){let o=n.call(this,e);if(N("onPageShareAppMessage")){const n=J("onPageShareAppMessage",this,o,e);if(t(n)){o=n}}return o}}};const Se=function(e){if(rt.enableGlobalShareTimeline&&!e.onShareTimeline){e.onShareTimeline=function(){let e={title:$(),query:this.$rawParamsQuery};if(N("onPageShareTimeline")){const n=J("onPageShareTimeline",this,e);if(t(n)){e=n}}return e}}};const $e=function(e){const n=e.onShareTimeline;if(n){e.onShareTimeline=function(){let e=n.call(this);if(N("onPageShareTimeline")){const n=J("onPageShareTimeline",this,e);if(t(n)){e=n}}return e}}};const xe=function(e){const o=[];let s=e;let r=null;let i;while(s=s.$parent){r=s.provide;i=true;if(r){if(n(r)){i=false;r=s.provide()}if(t(r)){o.push({parent:s,provide:r,isStatic:i})}}}return o};class ye{constructor(t,e,n){this.parent=t;this.context=e;this.key=n}update(){const t=this.parent.provide();const e=this.key;const o=t[e];if(n(o)){this.context[e]=o.bind(this.parent)}else{this.context.setData({[e]:o})}}}const ve=function(t,e){const o=t.inject;if(t.provide){e.provide=t.provide}if(r(o)&&o.length){const t=xe(e);o.forEach((o=>{for(let r=0;r<t.length;r++){const{parent:i,provide:c,isStatic:a}=t[r];if(s(c,o)){if(!a){if(!i.$provideWatchers){i.$provideWatchers=[];const t=i.setData;i.setData=function(){const e=t.apply(this,arguments);this.$provideWatchers.forEach((t=>t.update()));return e}}i.$provideWatchers.push(new ye(i,e,o));if(!e.$parentProvides){e.$parentProvides=[]}if(!e.$parentProvides.includes(i)){e.$parentProvides.push(i)}}const t=c[o];if(n(t)){e[o]=t.bind(i)}else{e.setData({[o]:t})}break}}}))}};const Pe=function(t,e){return new Proxy(t,{get(t,e){return t[e]},set(t,n,o){const s=t[n];if(s!==o){e&&e({[n]:o},{[n]:s},"store")}t[n]=o;return true}})};let be=null;const Te=function(t){be=t};v(globalThis,"getApplication",(function(){return getApp()||be}));v(globalThis,"getSavedPages",A);v(globalThis,"getSavedTabBars",C);v(globalThis,"getSavedAppBars",j);App=function(e={}){const{storeKey:n}=rt;W(e);if(!t(e[n])){e[n]={}}e[n]=Pe(e[n],Nt);const o=function(...t){Te(this);st(this,"onAppLaunch",...t)};const s=function(){st(this,"onAppHide")};const r=function(){st(this,"onAppShow")};oe(e,"onLaunch",o);oe(e,"onHide",s);oe(e,"onShow",r);se(e);return ct(e)};const Ee=function(t,e,n){if(t._ignore){return}const o=t[e]||f;t[e]=function(){if(n.apply(this,arguments)===false){return}return o.apply(this,arguments)};t._ignore=true};const Oe=function(t){const e=function(e){const n=L.resolve(t.is,e.url);return J("beforePageEnter",Object.assign({},e,{url:n}),x(u(n)))};Ee(t.pageRouter,"navigateTo",e);Ee(t.pageRouter,"redirectTo",e);Ee(t.pageRouter,"reLaunch",e);Ee(t.pageRouter,"switchTab",e);Ee(t.router,"navigateTo",e);Ee(t.router,"redirectTo",e);Ee(t.router,"reLaunch",e);Ee(t.router,"switchTab",e)};let _e=null;const ke=function(t){_e={data:t.body,url:u(t.url)}};const Ae=function(t,e){if(_e&&_e.data&&_e.url===e.route){c(t,_e.data);_e=null}};let Be=null;const Ce=function(t){const e=t.url.split("?")[1];if(e){Be={url:u(t.url),data:g(e)}}};const je=function(t,e){if(Be&&S(e.route)&&Be.url===e.route){c(t,Be.data);Be=null}};const De=function(t){let e=null;const n=S(t.route);if(Be&&n&&Be.url===t.route&&t._wakeUp){const n={};je(n,t);c(t.$params,n);t.$rawParamsQuery=h(t.$params);t.$rawParams=c({},t.$params);m(n,!rt.parseUrlArgs);m(t.$params,!rt.parseUrlArgs);e=n}if(n&&t._wakeUp){if(t.onSwitchTab){t.onSwitchTab(e||{})}Ie("switchTab").call(t,e||{})}};const Le=t=>{if(n(t.getTabBar)){const e=t.getTabBar();if(e&&n(e.setData)){return e}return null}return null};const Ue=function(t){return function(e){E(this);pe(this);ae(this);Ae(e,this);je(e,this);Oe(this);le(this);ee(t,this);ne(this);ge(t,this);if(S(this.route)){const t=this.getTabBar();if(t){ee(t.$constructorOptions,t);ne(t);ge(t.$constructorOptions,t)}}de(this);he(t,this);this.$rawParamsQuery=h(e);this.$rawParams=c({},e);this.$route=this.route;m(e,!rt.parseUrlArgs);this.$params=e;const n=Le(this);if(n){n.$page=this;n.$feature=this.$feature;n.$route=this.route}st(this,"onPageLoad",{option:e,path:this.route});J("onPageLoad",this,{option:e,path:this.route})}};const Re=(t,e,n)=>{const o=Le(t);if(o&&o.$constructorOptions&&o.$constructorOptions.pageLifetimes&&o.$constructorOptions.pageLifetimes[e]){o.$constructorOptions.pageLifetimes[e].call(o,n)}};const Me=function(t){const e=t.onShow||f;t.onShow=function(){De(this);st(this,"onPageShow",{option:this.$params,path:this.route});J("onPageShow",this);Re(this,"show");const t=e.call(this);if(this._wakeUp&&this.onWakeup){this.onWakeup()}v(this,"_wakeUp",true);return t}};const Ie=function(t,e){return function(n){st(this,e,c({path:this.route},n||{}));B().forEach((({context:e,page:n,option:o})=>{if(n===this&&o.pageLifetimes&&o.pageLifetimes[t]){o.pageLifetimes[t].apply(e,arguments)}}));Re(this,t,n)}};Page=function(t){Ot(t);we(t);me(t);$e(t);Se(t);oe(t,"onLoad",Ue(t));Me(t);oe(t,"onUnload",(function(){O(this);J("onPageUnload",this)}));oe(t,"onPullDownRefresh",Ie("pullDownRefresh","onPagePullDownRefresh"));oe(t,"onReachBottom",Ie("reachBottom","onPageReachBottom"));oe(t,"onPageScroll",Ie("pageScroll","onPageScroll"));t[`${rt.methodPrefix}finish`]=function(t){Dt(t,this)};t[`${rt.methodPrefix}invoke`]=function(t,...e){if(this.$opener&&n(this.$opener[t])){return this.$opener[t](...e)}};se(t);Et(t,"page");return at(t)};const We=function(t,e){let{exports:o}=t;const s=e.selectOwnerComponent();if(o&&s){if(n(o)){o=o.call(e)}e.$exports=o;const{namespace:t=null,methods:r={}}=o;if(t&&s[t])return;let i=s;if(t){i=s[t]={$installedBy:e}}for(let t in r){const o=r[t];if(r.hasOwnProperty(t)&&n(o)&&!i[t]){i[t]=o.bind(e);i[t].$installedBy=e}}}};const Ne=function(t,e){const n=e.selectOwnerComponent();const o=e.$exports;if(!n||!o)return;const{namespace:s=null,methods:r={}}=o;if(s){if(n[s]&&n[s].$installedBy===e){delete n[s]}}else{for(let t in r){if(n[t]&&n[t].$installedBy===e){delete n[t]}}}};const Je=function(){return p(this).$params};const Ke=function(t,e){t=t||{};t.methods=t.methods||{};t.lifetimes=t.lifetimes||{};const o=t.lifetimes.created||t.created||f;const s=t.lifetimes.attached||t.attached||f;const r=t.lifetimes.ready||t.ready||f;const i=t.lifetimes.detached||t.detached||f;const c=function(){try{pe(this);Oe(this)}catch(t){}if(e===ut){J("onComponentCreated",this)}return o.apply(this,arguments)};const a=function(){const n=e===ut;if(n){this.$constructorOptions=t}const o=p(this);if(o.route){_({context:this,option:t,type:n?"component":"behavior",page:o})}this.$route=o.route;this.$feature=o.$feature;this.$page=o;ee(t,this);ne(this);if(n){We(t,this);const e=this.selectOwnerComponent();if(e){if(!e.$components){e.$components=[]}e.$components.push(this);this.$parent=e;ve(t,this)}}ge(t,this);if(n){de(this);J("onComponentAttached",this)}return s.apply(this,arguments)};const u=function(){J("onComponentReady",this);return r.apply(this,arguments)};const l=function(){const t=k(this);if(t.type==="component"){Ne(t.option,this);const e=this.selectOwnerComponent();if(e){if(e.$components){const t=e.$components.indexOf(this);if(t>-1){e.$components.splice(t,1);this.$parent=null}}if(this.$parentProvides){this.$parentProvides.forEach((t=>{const e=t.$provideWatchers.findIndex((t=>t.context===this));if(e>-1){t.$provideWatchers.splice(e,1)}}))}}J("onComponentDetached",this)}return i.apply(this,arguments)};t.lifetimes.created=c;t.lifetimes.attached=a;t.lifetimes.ready=u;t.lifetimes.detached=l;Ot(t.methods,false);t.methods[`${rt.methodPrefix}finish`]=function(t){Dt(t,this.$page)};se(t.methods);if(e===ut){Et(t.methods,"component");t.methods[`${rt.methodPrefix}invoke`]=function(t,...e){if(this.$page.$opener&&n(this.$page.$opener[t])){this.$page.$opener[t](...e)}};t.methods[`${rt.methodPrefix}getUrlParams`]=Je;t.methods[`${rt.methodPrefix}getPageInstance`]=function(){return p(this)};t.methods[`${rt.methodPrefix}getCognateComponents`]=Zt}return e(t)};Component=function(t){return Ke(t,ut)};Behavior=function(t){return Ke(t,ft)};function Ge(t={}){c(rt,t);Fe()}const Qe={extend(t,e){if(t==="wx"){console.warn("global.extend: 不能重复定义wx")}else{Object.defineProperty(globalThis,t,{get:()=>e})}}};const He={openPage:wx.openPage,replacePage:wx.replacePage,getStore:wx.getStore,setGlobbalData:wx.setStore,finish:wx.finish,getNavigateBarTitle:wx.getNavigateBarTitle,getTabBarPages:wx.getTabBarPages,isTabBarPage:wx.isTabBarPage,getConfigJson:wx.getConfigJson,fireEvent:wx.fireEvent};function Fe(){c(wx,He);const{methodPrefix:t}=rt;wx[`${t}openPage`]=Ct;wx[`${t}replacePage`]=jt;wx[`${t}getStore`]=Xt;wx[`${t}setStore`]=Yt;wx[`${t}finish`]=function(t){Dt(t,te())};wx[`${t}getNavigateBarTitle`]=$;wx[`${t}getTabBarPages`]=w;wx[`${t}isTabBarPage`]=S;wx[`${t}getConfigJson`]=x;wx[`${t}fireEvent`]=Wt;wx.getStorageSync=Qt;wx.setStorage=Jt;wx.setStorageSync=Ht;wx.removeStorageSync=qt;wx.removeStorage=Gt;wx.batchSetStorage=Kt;wx.batchSetStorageSync=Ft;wx.clearStorage=zt;wx.clearStorageSync=Vt;wx.navigateTo=Ut;wx.redirectTo=Rt;wx.reLaunch=Mt;wx.switchTab=It}Fe();const qe=ot;const ze=Ge;const Ve=bt;const Xe=Tt;const Ye=Qe;const Ze={setStorage:Jt,removeStorage:Gt,getStorageSync:Qt,setStorageSync:Ht,removeStorageSync:qt,clearStorage:zt,clearStorageSync:Vt,batchSetStorage:Kt,batchSetStorageSync:Ft,setStore:Yt,getStore:Xt,reLaunch:Mt,navigateTo:Ut,redirectTo:Rt,switchTab:It,getNavigateBarTitle:$,getTabBarPages:w,isTabBarPage:S,getConfigJson:x};Ye.extend("wxbuf",Ze);Object.defineProperty(Ze,"version",{get:()=>"1.0",configurable:false});var tn={page:Ve,watch:qe,config:ze,global:Ye,component:Xe};export{Xe as component,ze as config,tn as default,Ye as global,Ve as page,qe as watch};
